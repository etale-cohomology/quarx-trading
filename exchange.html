<!doctype html>
<html lang='en'>

  <head>
    <title>Quarx | Stellar network trading client</title>

    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>  <!-- Key for responsiveness! -->

    <link rel='shortcut icon' href='favicon.png'>
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Montserrat:500,800|Material+Icons'>
    <link rel='stylesheet' href='material.blue-red.min.css'>
    <link rel='stylesheet' href='style.css'>
    <style>
      /*----------------------------------------------------------------------*/
      .axis text{ fill:#ffffff; font:10px 'Montserrat'; }
      text.ticker{ fill:#ffffff; font:10px 'Montserrat'; }
      path.candle{ stroke:#000000; }
      path.candle.body{ stroke-width:0; }
      path.candle.up{ fill:#00aa00; stroke:#00aa00; }
      path.candle.down{ fill:#ff0000; stroke:#ff0000; }

      path.volume{ fill:#444444; opacity:0.5; }
      path.volume.up{ fill:#00aa00; }
      path.volume.down{ fill:#ff0000; }

      rect.pane{ cursor:move; fill:none; pointer-events:all; }

      /*---------------------*/
      .indicator path.line{ fill:none; stroke-width:1; }
      .ma-0 path.line{ stroke:#1f77b4; }
      .ma-1 path.line{ stroke:#aec7e8; }
      .ma-2 path.line{ stroke:#ff7f0e; }

      /*----------------------------------------------------------------------*/
      .rsi path{ fill:none; stroke-width:1; }
      .rsi{ stroke:#ffffff; }
      .rsi path.overbought, .rsi path.oversold{ stroke:#ff9999; stroke-dasharray:5, 5; }
      .rsi path.middle, path.zero{ stroke:#bbbbbb; stroke-dasharray:5, 5; }

      /*----------------------------------------------------------------------*/
      .stochastic path { fill: none; stroke-width: 1; }
      .stochastic.up { stroke: #00aa00; }
      .stochastic.down { stroke: #ff0000; }
      .stochastic path.overbought, .stochastic path.oversold { stroke: #ff9999; stroke-dasharray: 5, 5; }
      
      /*----------------------------------------------------------------------*/
      .williams path { fill: none; stroke-width: 1; }
      .williams.up { stroke: #ffffff; stroke-width: 1.5; }

      /*----------------------------------------------------------------------*/
      .mdl-card__title{ font-weight:bold; padding:16px; }
      .main_textfield{ width:90%; color:#ffffff; }
      @media screen and (max-width:414px){ .main_textfield{ width:80%; } }
    </style>
  </head>

  <body>

    <!-- --------------------------------------------------------------------------------------------------- -->
    <div class='mdl-layout mdl-js-layout mdl-layout--fixed-header'>

      <!-- ---------------------------------------------------------------------- -->
      <header class='mdl-layout__header bg_dark'>
        <div class='mdl-layout__header-row'>

          <h1 id='title0' class='mdl-typography--title montserrat bold'>Quarx</h1>

          <!-- <div class='mdl-layout-spacer'></div>
          <button id='btn_horizon' class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-color-text--white'>testnet</button> -->

        </div>
      </header>

      <!-- ---------------------------------------------------------------------- -->
      <div class='mdl-layout__drawer bg_dark'> <!-- 1.2 mdl-layout__drawer! -->

        <a href='/'><div class='drawer_header'></div></a>

        <nav class='mdl-navigation'>
          <a class='mdl-navigation__link' href='mass.html'><div class='material-icons'>extension</div>Mass markets</a>
          <!-- <a class='mdl-navigation__link' href='single.html'><div class='material-icons'>accessibility</div>Single markets</a> -->
          <a class='mdl-navigation__link' href='xlm.html'><div class='material-icons'>view_week</div>External markets</a>
          <hr class='mdl-color--white border_none'>
          <a class='mdl-navigation__link' href='https://github.com/etale-cohomology/quarx-trading'><div class='material-icons'>business</div>Source</a>
        </nav>

      </div>

      <!-- ---------------------------------------------------------------------- --> <!-- Content! -->
      <main class='mdl-layout__content mdl-color--grey-900'>

        <!-- ------------------------------------------------- -->
        <div class='mdl-grid mdl-grid--no-spacing mdl-color-text--white margin_top flex_justify_center margin_bottom5'>

          <!-- --------------------- -->
          <div class='mdl-cell mdl-cell--12-col'><h1 id='exchange' class='mdl-typography--headline montserrat margin_left'>Exchange</h1></div>

          <!-- --------------------- -->
          <div class='mdl-cell mdl-cell--9-col'>

            <!-- ------- -->
            <div class='mdl-grid'>
              <div class='mdl-card mdl-shadow--4dp mdl-color--grey-900'><div id='chart0' class='mdl-cell mdl-cell--12-col'></div></div>
              <div class='mdl-card mdl-shadow--4dp mdl-color--grey-900'><div id='chart1' class='mdl-cell mdl-cell--12-col'></div></div>
              <div class='mdl-card mdl-shadow--4dp mdl-color--grey-900'><div id='chart2' class='mdl-cell mdl-cell--12-col'></div></div>
              <div class='mdl-card mdl-shadow--4dp mdl-color--grey-900'><div id='chart3' class='mdl-cell mdl-cell--12-col'></div></div>
            </div>

          </div>

          <!-- --------------------- -->
          <div class='mdl-cell mdl-cell--2-col'>

            <div class='mdl-grid mdl-grid--no-spacing flex_justify_center'>

              <div class='mdl-cell mdl-cell--12-col'>
                <h1 id='orderbook_date' class='montserrat text_center'>Orderbook updated</h1>
                <h2 id='ledger_sequence' class='montserrat text_center margin_bottom'>Ledger</h2>
              </div>
              
              <div class='mdl-cell mdl-cell--6-col'>

                <h2 id='bids_title' class='montserrat'>Bids</h2>
                <table id='bids_table' class='mdl-data-table mdl-js-data-table mdl-shadow--2dp mdl-color--grey-900 bids_table'>
                  <thead><tr><th>Market size</th><th>Price</th></tr></thead>
                  <tbody></tbody>
                </table>

                <div class='mdl-card mdl-shadow--2dp mdl-color--grey-900'>
                  <div class='mdl-card__supporting-text mdl-color-text--white montserrat'>Spread (CNY)</div>
                  <div class='mdl-card__title'>
                    <div id='spread_absolute' class='mdl-card__title-text mdl-color-text--white montserrat'></div>
                  </div>
                </div>

                <div class='mdl-card mdl-shadow--2dp mdl-color--grey-900'>
                  <div class='mdl-card__supporting-text mdl-color-text--white montserrat'>Spread (%)</div>
                  <div class='mdl-card__title'>
                    <div id='spread_relative' class='mdl-card__title-text mdl-color-text--white montserrat'></div>
                  </div>
                </div>

                <h2 id='asks_title' class='montserrat'>Asks</h2>
                <table id='asks_table' class='mdl-data-table mdl-js-data-table mdl-shadow--2dp mdl-color--grey-900 asks_table'>
                  <thead><tr><th>Market size</th><th>Price</th></tr></thead>
                  <tbody></tbody>
                </table>

              </div>

              <div class='mdl-cell mdl-cell--6-col'>
                <h1 id='trades_last'>Last trades</h1>
                <table id='trades_table' class='mdl-data-table mdl-js-data-table mdl-shadow--2dp mdl-color--grey-900'>
                  <thead><tr><th>Trade size</th><th>Price</th><th>Time</th></tr></thead>
                  <tbody></tbody>
                </table>
              </div>

            </div>

          </div>

          <!-- --------------------- -->
          <div class='mdl-cell mdl-cell--6-col flex_justify_center'>

            <div class='mdl-card mdl-shadow--4dp width_100 mdl-color--grey-800'>

              <div class='mdl-card__title mdl-color--black mdl-color-text--white vcenter_parent'>
                <h2 id='card_title_buy' class='mdl-typography--headline vcenter_child bold'>Buy</h2>
                <div class='mdl-layout-spacer'></div>
                <button class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon' id='help_buy'><i class='material-icons'>help_outline</i></button>
                <div class='mdl-tooltip' for='help_buy'>Buy asset.</div>
              </div>

              <div class='mdl-card__supporting-text width_100'>
                <button class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white margin_right3' id='help_buy_asset_issuer'><i class='material-icons'>gavel</i></button>
                <div class='mdl-tooltip' for='help_buy_asset_issuer'>In the Stellar network, an <b>asset</b> is specified by two pieces of data: 1) an asset code and 2) an <b>asset issuer</b>. This means that, in order to buy an asset, you need both the asset code and the asset issuer. An asset issuer is an account that created and first sent an asset. All assets except Lumens have an issuer.</div>
                <div class='mdl-textfield mdl-js-textfield main_textfield'>
                  <input class='mdl-textfield__input' type='text' id='input_asset_issuer'/>
                  <label class='mdl-textfield__label mdl-color-text--grey-400'>Asset issuer</label>
                </div>
              </div>

              <div class='mdl-card__supporting-text width_100'>
                <button class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white margin_right3' id='help_buy_amount'><i class='material-icons'>whatshot</i></button>
                <div class='mdl-tooltip' for='help_buy_amount'>Amount to buy.</div>
                <div class='mdl-textfield mdl-js-textfield main_textfield'>
                  <input class='mdl-textfield__input' type='text' id='input_asset_issuer'/>
                  <label class='mdl-textfield__label mdl-color-text--grey-400'>Amount to buy</label>
                </div>
              </div>

              <div class='mdl-card__supporting-text width_100'>
                <button class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white margin_right3' id='help_buy_secret_seed'><i class='material-icons'>lock_outline</i></button>
                <div class='mdl-tooltip' for='help_buy_secret_seed'>Secret seed.</div>
                <div class='mdl-textfield mdl-js-textfield main_textfield'>
                  <input class='mdl-textfield__input' type='text' id='input_asset_issuer'/>
                  <label class='mdl-textfield__label mdl-color-text--grey-400'>Secret seed</label>
                </div>
              </div>

              <div class='mdl-card__actions mdl-card--border vcenter_parent margin_top4'>
                <div class='mdl-layout-spacer'></div>
                <div id='spinner_buy' class='mdl-spinner mdl-js-spinner vcenter_child margin_right3'></div>
                <button id='btn_buy' class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--raised mdl-button--accent vcenter_child vcenter_parent mdl-button--disabled'>buy<i class='material-icons vcenter_child margin_left4'>send</i></button>
              </div>

            </div>

          </div>

          <!-- --------------------- -->
          <div class='mdl-cell mdl-cell--6-col flex_justify_center'>

            <div class='mdl-card mdl-shadow--4dp width_100 mdl-color--grey-800'>

              <div class='mdl-card__title mdl-color--black mdl-color-text--white vcenter_parent'>
                <h2 id='card_title_sell' class='mdl-typography--headline vcenter_child bold'>Sell</h2>
                <div class='mdl-layout-spacer'></div>
                <button class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon' id='help_sell'><i class='material-icons'>help_outline</i></button>
                <div class='mdl-tooltip' for='help_sell'>Sell asset.</div>
              </div>

              <div class='mdl-card__supporting-text width_100'>
                <button class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white margin_right3' id='help_sell_asset_issuer'><i class='material-icons'>gavel</i></button>
                <div class='mdl-tooltip' for='help_sell_asset_issuer'>In the Stellar network, an <b>asset</b> is specified by two pieces of data: 1) an asset code and 2) an <b>asset issuer</b>. This means that, in order to sell an asset, you need both the asset code and the asset issuer. An asset issuer is an account that created and first sent an asset. All assets except Lumens have an issuer.</div>
                <div class='mdl-textfield mdl-js-textfield main_textfield'>
                  <input class='mdl-textfield__input' type='text' id='input_asset_issuer'/>
                  <label class='mdl-textfield__label mdl-color-text--grey-400'>Asset issuer</label>
                </div>
              </div>

              <div class='mdl-card__supporting-text width_100'>
                <button class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white margin_right3' id='help_sell_amount'><i class='material-icons'>whatshot</i></button>
                <div class='mdl-tooltip' for='help_sell_amount'>Amount to sell.</div>
                <div class='mdl-textfield mdl-js-textfield main_textfield'>
                  <input class='mdl-textfield__input' type='text' id='input_asset_issuer'/>
                  <label class='mdl-textfield__label mdl-color-text--grey-400'>Amount to sell</label>
                </div>
              </div>

              <div class='mdl-card__supporting-text width_100'>
                <button class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white margin_right3' id='help_sell_secret_seed'><i class='material-icons'>lock_outline</i></button>
                <div class='mdl-tooltip' for='help_sell_secret_seed'>Secret seed.</div>
                <div class='mdl-textfield mdl-js-textfield main_textfield'>
                  <input class='mdl-textfield__input' type='text' id='input_asset_issuer'/>
                  <label class='mdl-textfield__label mdl-color-text--grey-400'>Secret seed</label>
                </div>
              </div>

              <div class='mdl-card__actions mdl-card--border vcenter_parent margin_top4'>
                <div class='mdl-layout-spacer'></div>
                <div id='spinner_sell' class='mdl-spinner mdl-js-spinner vcenter_child margin_right3'></div>
                <button id='btn_sell' class='mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--raised mdl-button--accent vcenter_child vcenter_parent mdl-button--disabled'>sell<i class='material-icons vcenter_child margin_left4'>send</i></button>
              </div>

            </div>

          </div>

          <!-- --------------------- -->
          <div class='mdl-cell mdl-cell--6-col'>

            <h2 class='mdl-typography--subhead montserrat text_center margin_top'>Market components</h2>
            <table id='market_components_table' class='mdl-data-table mdl-js-data-table mdl-shadow--2dp mdl-color--grey-900 hcenter'>
              <tbody></tbody>
            </table>

          </div>

        </div>  <!-- END mdl-grid -->

      </main>

    </div>

  </body>

  <script src='material.min.js'></script>
  <script src='stellar-sdk.min.js'></script>
  <script src='d3.v4.min.js'></script>
  <script src='techan.min.js'></script>
  <script src='main.js'></script>
  <script>
    // ---------------------------------------------------------------------------------------------------
    let MARKETS = {
      CNY: ['GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX',],
      JPY: ['GBVAOIACNSB7OVUXJYC5UE2D4YK2F7A24T7EE5YOMN4CE6GCHUTOUQXM'],
      BTC: ['GDXTJEK4JZNSTNQAWA53RZNS2GIKTDRPEUWDXELFMKU52XNECNVDVXDI', 'GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF', 'GBSTRH4QOTWNSVA6E4HFERETX4ZLSR3CIUBLK7AXYII277PFJC4BBYOG'],
      XRP: ['GA7FCCMTTSUIC37PODEL6EOOSPDRILP6OQI5FWCWDDVDBLJV72W6RINZ'],
    }


    // ---------------------------------------------------------------------------------------------------
    let asset0_code = url_get('asset0_code')
    let asset1_code = url_get('asset1_code')

    let asset0 = new StellarSdk.Asset.native()
    let asset1 = new StellarSdk.Asset(asset1_code, MARKETS[asset1_code][0])

    orderbook_get(asset0, asset1)
    trades_get(asset0, asset1)

    exchange_title(asset0_code, asset1_code)
    bidask_title(asset0_code, asset1_code)
    market_components(MARKETS[asset1_code])


    // ---------------------------------------------------------------------------------------------------
    // Set card titles!
    doc.querySelector('#card_title_buy').innerText = `Buy ${asset0_code.toUpperCase()}`
    doc.querySelector('#card_title_sell').innerText = `Sell ${asset0_code.toUpperCase()}`
    doc.querySelector('#btn_buy').innerHTML = `Buy ${asset0_code.toUpperCase()} <i class='material-icons vcenter_child margin_left4'>send</i>`
    doc.querySelector('#btn_sell').innerHTML = `Sell ${asset0_code.toUpperCase()} <i class='material-icons vcenter_child margin_left4'>send</i>`

  </script>

</html>
